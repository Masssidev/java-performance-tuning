# 튜닝의 절차는 그때그때 달라요
'암달의 법칙' - 1 Core에서 20시간 소요되는 작업 중 1시간은 절대 개선할 수 없다면, 20배 이상의 성능 향상은 불가능하다.

성능 개선율 = 1/(1-P) + P/S
* P: 개선 가능한 부분의 비율
* S: 개선된 정도

만약 개선 가능한 부분이 100%이면, P는 1이된다. 그리고 2배의 성능 향상이 이루어 졌다면, S=2가 된다.<br/>
> 성능 개선율은 2가 된다.<br/>
> 그래프로 그려 보면 성능 개선에는 한계가 생길 수 밖에 없다.(증가하다가 추세가 꺾이는 부분이 발생한다.)<br/>
> 아무리 최적화된 시스템이라고 할지라도 생각지도 못한 부분의 성능 저하는 발생할 수 밖에 없다.
<hr/>

### 성능 튜닝 step by step
1. 원인 파악
  * 시간 낭비를 하지 않으려면, 어디가 병목인지 확실히 파악하여 원인을 찾아야 한다.
2. 목표 설정
  * 성능 개선뿐만 아니라, 향후 유지보수까지 모두 고려해서 목표를 설정하는 것이 좋다.
3. 튜닝 실시
  * 코드를 최적화하며 튜닝한다.(프로파일링 툴이나 APM과 같은 툴을 사용)
4. 개선율 확인
  * 만족스럽지 않은 경우에는 '튜닝 실시'단계로 다시 넘어가서 진행.
  * 원인을 잘못 판단했을 경우 '원인 파악'부터 다시 진행.
5. 결과 정리 및 반영
  * 튜닝한 결과를 정리. 문서나 메일, 위키, 메모 툴 등
<hr/>

### 성능 튜닝의 비법
* 하나만 보지 말아라.
    * 병목 지점은 이 세상에 있는 병목 지점의 일부분일 뿐.
* 큰 놈을 없애라.
  * 애플리케이션의 가장 큰 성능 저하가 발생하는 부분을 찾아서 튜닝해야만 한다.
* 깊게 알아야 한다.
  * 개발 언어, OS, DB, N/W, 서버 모든 것의 전문가가 되기는 어려우니 하나라도 전문가가 되자.
* 결과 공유는 선택이 아닌 필수!
  * 개요: 튜닝을 실시한 배경
  * 튜닝 환경: 튜닝을 실시하고 성능을 측정한 서버 및 툴에 대한 상세한 내용
  * 튜닝 결과: 튜닝 전과 후의 결과를 비교
  * 결론: 어느 부분을 어떻게 변경하는 것이 가장 큰 효과를 줄지, 튜닝 작업을 진행한 담당자의 의견 등을 포함
  * 유의사항
      * 확실한 결과 위주로 포함하자.
      * 개선 효과가 가장 큰 것부터 나열하자.
      * 개발한 사람의 심기를 나쁘게 하지 말자.

###### 그래프를 그릴 때 유의사항
* 전반적으로, 
    * 그래프의 타이틀은 반드시 추가한다. 
    * 그래프의 라벨은 가능하면 X축 하단에 넣자.
    * 산포도를 보여줄 때, 데이터를 나타내는 각 점은 되도록이면 작게 표현하자.
* Y축을 그릴 때, 
    * 정수 값일 경우 1,000단위에 콤마를 추가하자.
    * 소수까지 내려가는 값일 경우 적어도 3자리를 보여주자.
    * 주 단위를 표시하는 경우에는 그래프 내에 주 단위가 4개 이상 표시되지 않는 것이 좋다.
* X축을 그릴 때,
    * X축의 주 단위는 10개 내외로 보여 주는 것이 좋다.
    * 주 단위를 선으로 보여 줄지, 눈금으로만 보여 줄지는 상황에 맞게 결정하자.

###### 병목의 대상 목록
대상 | 세부 대상
:-----:|:------
서버 장비 | CPU, Network, Disk, Memory 등
서버 OS | OS 커널, OS 설정, 수행중인 프로세스 등
자바 애플리케이션 | 스레드 풀 설정, DB Connection Pool 설정, Cache 설정, GC 설정, Heap 크기 설정, 검증되지 않은 프레임워크의 버그, 개발된 애플리케이션 등
웹 서버 | 프로세스 개수 설정, Connector 설정, 개발된 모듈의 버그 등
네트워크 | 사용자의 네트워크의 종류, 사용자의 위치, L4 및 Switch 등 네트뭐크 장비, 방화벽 등
클라이언트 | 클라이언트 장비의 CPU, Network, Dist, Memory, OS 등의 성능, 클라이언트 애플리케이션, 클라이언트 장비에서 수행 중인 프로세스 등
